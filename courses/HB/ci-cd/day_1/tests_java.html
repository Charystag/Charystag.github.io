<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Tests Java - CI-CD</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Day 1</li><li class="chapter-item expanded "><a href="../day_1/Github-actions-guided.html"><strong aria-hidden="true">1.</strong> Github Actions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day_1/Github-actions-non-guided.html"><strong aria-hidden="true">1.1.</strong> non guided</a></li></ol></li><li class="chapter-item expanded "><a href="../day_1/tests_java.html" class="active"><strong aria-hidden="true">2.</strong> Tests Java</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day_1/tests_java_non_guide.html"><strong aria-hidden="true">2.1.</strong> non guided</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CI-CD</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="tp-guidé--de-maven-local-à-lintégration-continue-avec-github-actions-java"><a class="header" href="#tp-guidé--de-maven-local-à-lintégration-continue-avec-github-actions-java">TP Guidé : De Maven Local à l'Intégration Continue avec GitHub Actions (Java)</a></h1>
<p><strong>Objectif Général :</strong>
Ce TP est divisé en deux grands exercices.</p>
<ol>
<li><strong>Exercice 1 :</strong> Maîtriser le cycle de développement et de test d'un projet Java avec Maven, entièrement en local, en appliquant une approche TDD-light.</li>
<li><strong>Exercice 2 :</strong> Prendre le projet fonctionnel localement et mettre en place une chaîne d'Intégration Continue (CI) avec GitHub Actions pour automatiser les builds et les tests.</li>
</ol>
<p><strong>Prérequis :</strong></p>
<ul>
<li>Git installé et configuré.</li>
<li>JDK (version 8 ou supérieure, compatible avec l'archétype ; 11+ est bien pour la CI) et Apache Maven installés.</li>
<li>Un compte GitHub.</li>
</ul>
<hr />
<h2 id="exercice-1--maîtriser-maven-en-local-avec-une-approche-tdd-light"><a class="header" href="#exercice-1--maîtriser-maven-en-local-avec-une-approche-tdd-light">Exercice 1 : Maîtriser Maven en Local avec une Approche TDD-Light</a></h2>
<p><strong>Objectif :</strong> Créer un projet Java avec Maven, le compiler et tester avec <code>mvn package</code>, puis ajouter une nouvelle fonctionnalité en suivant un mini-cycle TDD (écrire un test qui échoue, écrire le code pour le faire passer).</p>
<h3 id="11-générer-le-projet-maven"><a class="header" href="#11-générer-le-projet-maven">1.1. Générer le Projet Maven</a></h3>
<ol>
<li>
<p><strong>Ouvre ton terminal</strong> et navigue vers le dossier où tu souhaites créer ton projet.</p>
</li>
<li>
<p><strong>Génère le projet</strong> avec la commande standard de l'archétype <code>maven-archetype-quickstart</code>:</p>
<pre><code class="language-bash">mvn archetype:generate -DgroupId=com.maventdd.app -DartifactId=maSuperAppJava -DarchetypeArtifactId=maven-archetype-quickstart -DarchetypeVersion=1.4 -DinteractiveMode=false
</code></pre>
<ul>
<li>Cela crée un dossier <code>maSuperAppJava</code>.</li>
</ul>
</li>
<li>
<p><strong>Navigue dans le dossier du projet</strong> :</p>
<pre><code class="language-bash">cd maSuperAppJava
</code></pre>
<p>Tu y trouveras la structure Maven classique avec un <code>pom.xml</code>, <code>src/main/java/com/maventdd/app/App.java</code> et <code>src/test/java/com/maventdd/app/AppTest.java</code>.
L'archétype <code>maven-archetype-quickstart:1.4</code> utilise typiquement JUnit 4.x. Pour cet exercice, <strong>nous n'allons PAS modifier le <code>pom.xml</code> initialement</strong> pour les dépendances de test, on utilise ce qui est fourni.</p>
<p><em>Optionnel (mais bonne pratique pour la suite et la CI) :</em> Tu peux juste t'assurer que ton <code>pom.xml</code> spécifie une version de Java pour le compilateur que tu utiliseras aussi dans GitHub Actions (par exemple Java 11). Si la section <code>&lt;properties&gt;</code> n'existe pas, ajoute-la. Si elle existe, ajoute ou modifie <code>maven.compiler.source</code> et <code>maven.compiler.target</code> :</p>
<pre><code class="language-xml">&lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
&lt;/properties&gt;
</code></pre>
</li>
</ol>
<h3 id="12-premier-build-et-tests-locaux-cycle-vert-initial"><a class="header" href="#12-premier-build-et-tests-locaux-cycle-vert-initial">1.2. Premier Build et Tests Locaux (Cycle Vert Initial)</a></h3>
<p>La commande <code>mvn package</code> va compiler ton code, exécuter les tests (ceux de <code>AppTest.java</code> qui sont fournis et qui doivent passer), et créer un fichier JAR.</p>
<ol>
<li><strong>Lance le build complet (compilation, tests, packaging) :</strong>
<pre><code class="language-bash">mvn package
</code></pre>
Tu devrais voir des logs de compilation et de test, et à la fin : <code>[INFO] BUILD SUCCESS</code>. Les tests par défaut sont passés. Le JAR est dans le dossier <code>target/</code>.</li>
</ol>
<h3 id="13-préparation-pour-le-cycle-tdd-light--nouvelle-fonctionnalité"><a class="header" href="#13-préparation-pour-le-cycle-tdd-light--nouvelle-fonctionnalité">1.3. Préparation pour le Cycle TDD-Light : Nouvelle Fonctionnalité</a></h3>
<p>Nous allons ajouter une classe <code>Calculatrice</code> avec une méthode <code>additionner</code>.</p>
<ol>
<li>
<p><strong>Crée la classe <code>Calculatrice.java</code></strong> dans <code>src/main/java/com/maventdd/app/</code> (à côté de <code>App.java</code>) :</p>
<pre><code class="language-java">package com.maventdd.app; // Assure-toi que le package est correct

public class Calculatrice {
    public int additionner(int a, int b) {
        // Laisser "cassé" ou non implémenté pour l'instant
        throw new UnsupportedOperationException("Méthode additionner() pas encore implémentée !");
    }
}
</code></pre>
</li>
<li>
<p><strong>Crée la classe de test <code>CalculatriceTest.java</code></strong> dans <code>src/test/java/com/maventdd/app/</code> (à côté de <code>AppTest.java</code>).
Utilise la syntaxe JUnit 4 (comme dans <code>AppTest.java</code> généré) :</p>
<pre><code class="language-java">package com.maventdd.app; // Assure-toi que le package est correct

import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.jupiter.api.Test;

public class CalculatriceTest {
    @Test
    public void testAdditionner() {
        Calculatrice calc = new Calculatrice();
        assertEquals(5, calc.additionner(2, 3));
    }
}
</code></pre>
</li>
<li>
<p><strong>Modifie <code>App.java</code></strong> pour instancier <code>Calculatrice</code> (juste pour s'assurer qu'elle est bien prise en compte par la compilation si besoin, bien que les tests devraient suffire) :</p>
<pre><code class="language-java">package com.maventdd.app;

public class App {
    public static void main( String[] args ) {
        System.out.println( "Hello World!" );
        Calculatrice calc = new Calculatrice(); // Ajout pour que la classe soit "vue"
    }
}
</code></pre>
</li>
</ol>
<h3 id="14-deuxième-build-et-tests-locaux-cycle-rouge"><a class="header" href="#14-deuxième-build-et-tests-locaux-cycle-rouge">1.4. Deuxième Build et Tests Locaux (Cycle Rouge)</a></h3>
<ol>
<li><strong>Relance le build complet :</strong>
<pre><code class="language-bash">mvn package
</code></pre>
Cette fois, tu devrais voir <code>[INFO] BUILD FAILURE</code>. Le nouveau test <code>CalculatriceTest.testAdditionner</code> échoue car la méthode <code>additionner</code> lève une exception (ou retourne une mauvaise valeur si tu as choisi cette option). C'est notre étape "rouge".</li>
</ol>
<h3 id="15-implémenter-la-fonctionnalité-cycle-vert"><a class="header" href="#15-implémenter-la-fonctionnalité-cycle-vert">1.5. Implémenter la Fonctionnalité (Cycle Vert)</a></h3>
<ol>
<li><strong>Modifie <code>Calculatrice.java</code></strong> pour implémenter correctement la méthode :
<pre><code class="language-java">package com.maventdd.app;

public class Calculatrice {
    public int additionner(int a, int b) {
        return a + b; // L'implémentation correcte !
    }
}
</code></pre>
</li>
<li><strong>Relance le build complet :</strong>
<pre><code class="language-bash">mvn package
</code></pre>
Maintenant, tu devrais revoir <code>[INFO] BUILD SUCCESS</code>. Tous les tests (ceux de <code>AppTest</code> et <code>CalculatriceTest</code>) passent.</li>
</ol>
<p><strong>Bravo pour cette première partie !</strong> Tu as vu comment Maven compile, teste, et package, et tu as fait un mini-cycle TDD en local.</p>
<hr />
<h2 id="exercice-2--intégration-continue-avec-github-actions"><a class="header" href="#exercice-2--intégration-continue-avec-github-actions">Exercice 2 : Intégration Continue avec GitHub Actions</a></h2>
<p><strong>Objectif :</strong> Automatiser le processus de build et de test avec GitHub Actions à chaque fois que tu pousses du code.</p>
<h3 id="21-versionner-le-projet-avec-git-et-pousser-sur-github"><a class="header" href="#21-versionner-le-projet-avec-git-et-pousser-sur-github">2.1. Versionner le Projet avec Git et Pousser sur GitHub</a></h3>
<ol>
<li>Si ce n'est pas déjà fait, <strong>initialise un dépôt Git</strong> à la racine de <code>maSuperAppJava</code> et fais ton premier commit avec le code fonctionnel :
<pre><code class="language-bash">git init
echo "target/" &gt; .gitignore
echo ".idea/" &gt;&gt; .gitignore
echo "*.iml" &gt;&gt; .gitignore
echo ".vscode/" &gt;&gt; .gitignore
echo ".DS_Store" &gt;&gt; .gitignore
# (Si tu avais déjà un .git, fais juste les add/commit nécessaires)
git add .
git commit -m "Projet Java Maven avec Calculatrice fonctionnelle et tests OK"
</code></pre>
</li>
<li><strong>Crée un dépôt distant</strong> sur GitHub (par exemple, nomme-le <code>maSuperAppJava-CI</code>).</li>
<li><strong>Lie ton dépôt local au dépôt distant</strong> et <strong>pousse ton code</strong> :
<pre><code class="language-bash">git remote add origin &lt;URL_DE_TON_DEPOT_GITHUB.git&gt;
git branch -M main
git push -u origin main
</code></pre>
</li>
</ol>
<h3 id="22-créer-le-workflow-github-actions"><a class="header" href="#22-créer-le-workflow-github-actions">2.2. Créer le Workflow GitHub Actions</a></h3>
<ol>
<li>
<p>À la racine de ton projet <code>maSuperAppJava</code>, crée le dossier <code>.github/</code> s'il n'existe pas, puis dedans un dossier <code>workflows/</code>.</p>
</li>
<li>
<p>Dans <code>.github/workflows/</code>, crée un fichier nommé <code>maven-ci.yml</code> (ou le nom que tu veux) avec le contenu suivant :</p>
<pre><code class="language-yaml">name: Java CI with Maven

on: [push] # Déclenche le workflow à chaque push sur n'importe quelle branche

jobs:
  build_and_test: # Nom du job
    runs-on: ubuntu-latest # Utilise une machine virtuelle Ubuntu fournie par GitHub

    steps:
      - name: Checkout code
        uses: actions/checkout@v4 # Action pour récupérer ton code du dépôt

      - name: Set up JDK 17 # Ou la version que tu as configurée dans ton pom.xml
        uses: actions/setup-java@v4 # Action pour configurer Java
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'maven' # Met en cache les dépendances Maven pour accélérer les builds suivants

      - name: Build and test with Maven
        working-directory: ./java/my-app # Attention a mettre le bon dossier
        run: mvn -B package # -B pour batch mode. 'package' compile, teste, et package.
</code></pre>
</li>
</ol>
<h3 id="23-push-du-workflow-et-vérification-sur-github-actions"><a class="header" href="#23-push-du-workflow-et-vérification-sur-github-actions">2.3. Push du Workflow et Vérification sur GitHub Actions</a></h3>
<ol>
<li><strong>Commit et push</strong> ton nouveau fichier de workflow :
<pre><code class="language-bash">git add .github/workflows/maven-ci.yml
git commit -m "Ajout du workflow GitHub Actions pour build et test Maven"
git push
</code></pre>
</li>
<li>Va sur ton dépôt GitHub, dans l'onglet <strong>"Actions"</strong>.</li>
<li>Tu devrais voir ton workflow (<code>Java CI with Maven</code>) s'exécuter. Clique dessus pour voir les détails des étapes (<code>steps</code>).</li>
<li>Le workflow devrait <strong>réussir</strong> (passer au vert), car il exécute <code>mvn -B package</code>, qui inclut les tests, et tous tes tests locaux passaient.</li>
</ol>
<h3 id="24-simuler-un-Échec-cycle-rouge-en-ci"><a class="header" href="#24-simuler-un-Échec-cycle-rouge-en-ci">2.4. Simuler un Échec (Cycle Rouge en CI)</a></h3>
<ol>
<li>Retourne dans ton code local, dans <code>Calculatrice.java</code>. <strong>Introduis une erreur</strong> dans la méthode <code>additionner</code> :
<pre><code class="language-java">// Dans Calculatrice.java
public int additionner(int a, int b) {
    return a + b + 1; // Oups, une erreur !
}
</code></pre>
</li>
<li><strong>Commit et push</strong> cette modification "cassée" :
<pre><code class="language-bash">git add src/main/java/com/maventdd/app/Calculatrice.java
git commit -m "Erreur intentionnelle dans Calculatrice.additionner"
git push
</code></pre>
</li>
<li>Retourne sur GitHub Actions. Le nouveau workflow lancé par ce push devrait <strong>échouer</strong> à l'étape "Build and test with Maven". Regarde les logs pour voir l'échec du test.</li>
</ol>
<h3 id="25-corriger-et-valider-cycle-vert-en-ci"><a class="header" href="#25-corriger-et-valider-cycle-vert-en-ci">2.5. Corriger et Valider (Cycle Vert en CI)</a></h3>
<ol>
<li>Dans ton code local, <strong>corrige l'erreur</strong> dans <code>Calculatrice.java</code> :
<pre><code class="language-java">// Dans Calculatrice.java
public int additionner(int a, int b) {
    return a + b; // C'est corrigé !
}
</code></pre>
</li>
<li><strong>Commit et push</strong> la correction :
<pre><code class="language-bash">git add src/main/java/com/maventdd/app/Calculatrice.java
git commit -m "Correction de Calculatrice.additionner"
git push
</code></pre>
</li>
<li>Sur GitHub Actions, le dernier workflow devrait maintenant <strong>réussir</strong>.</li>
</ol>
<hr />
<p><strong>Félicitations !</strong>
Tu as maintenant :</p>
<ul>
<li>Créé et testé un projet Java avec Maven en local.</li>
<li>Mis en place une Intégration Continue avec GitHub Actions qui build et teste ton projet à chaque push.</li>
<li>Expérimenté le cycle "rouge/vert" directement dans ton pipeline CI.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../day_1/Github-actions-non-guided.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../day_1/tests_java_non_guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../day_1/Github-actions-non-guided.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../day_1/tests_java_non_guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
