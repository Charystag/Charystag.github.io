<!DOCTYPE HTML>
<html lang="fr" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Application concrète - Formation AWS Jenkins &amp; Ansible</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../aws/introduction.html"><strong aria-hidden="true">1.</strong> Présentation générale d'AWS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../aws/sections/01_introduction.html"><strong aria-hidden="true">1.1.</strong> Introduction sur AWS</a></li><li class="chapter-item expanded "><a href="../../aws/sections/02_AWS_overview.html"><strong aria-hidden="true">1.2.</strong> Les Bases d'AWS</a></li><li class="chapter-item expanded "><a href="../../aws/sections/03_AWS_EC2.html"><strong aria-hidden="true">1.3.</strong> Les Instances EC2</a></li><li class="chapter-item expanded "><a href="../../aws/sections/04_AWS_S3.html"><strong aria-hidden="true">1.4.</strong> Les Buckets S3</a></li></ol></li><li class="chapter-item expanded "><a href="../../jenkins/introduction.html"><strong aria-hidden="true">2.</strong> Présentation générale de Jenkins</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../jenkins/sections/01_Introduction.html"><strong aria-hidden="true">2.1.</strong> Introduction sur Jenkins</a></li><li class="chapter-item expanded "><a href="../../jenkins/sections/02_First_Steps.html"><strong aria-hidden="true">2.2.</strong> Premiers pas avec Jenkins</a></li><li class="chapter-item expanded "><a href="../../jenkins/sections/03_Pipelines.html"><strong aria-hidden="true">2.3.</strong> Les bases des Pipelines</a></li><li class="chapter-item expanded "><a href="../../jenkins/sections/04_Pipelines_Advanced.html"><strong aria-hidden="true">2.4.</strong> Plus de pipelines!</a></li><li class="chapter-item expanded "><a href="../../jenkins/sections/05_modules_libraries.html"><strong aria-hidden="true">2.5.</strong> Modules et librairies dans Jenkins</a></li><li class="chapter-item expanded "><a href="../../jenkins/sections/06_AWS_automation.html"><strong aria-hidden="true">2.6.</strong> Automatisation dans AWS</a></li><li class="chapter-item expanded "><a href="../../jenkins/sections/07_Real_Life_Example.html" class="active"><strong aria-hidden="true">2.7.</strong> Application concrète</a></li></ol></li><li class="chapter-item expanded "><a href="../../ansible/introduction.html"><strong aria-hidden="true">3.</strong> Présentation générale d'Ansible</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ansible/sections/01_Introduction.html"><strong aria-hidden="true">3.1.</strong> Introduction à Ansible</a></li><li class="chapter-item expanded "><a href="../../ansible/sections/02_Basics.html"><strong aria-hidden="true">3.2.</strong> Bases d'ansible</a></li><li class="chapter-item expanded "><a href="../../ansible/sections/03_Automation.html"><strong aria-hidden="true">3.3.</strong> Automatisation avec ansible</a></li><li class="chapter-item expanded "><a href="../../ansible/sections/04_S3_management.html"><strong aria-hidden="true">3.4.</strong> Gestion de S3 avec ansible</a></li><li class="chapter-item expanded "><a href="../../ansible/sections/05_Jenkins_AWS_Pipeline.html"><strong aria-hidden="true">3.5.</strong> Ansible dans une pipeline Jenkins</a></li><li class="chapter-item expanded "><a href="../../ansible/sections/06_Best_Practices.html"><strong aria-hidden="true">3.6.</strong> Meilleures pratiques pour Ansible</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Formation AWS Jenkins &amp; Ansible</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="partie-7--cas-pratique-final---mise-en-place-dun-pipeline-cicd-avec-aws-et-jenkins"><a class="header" href="#partie-7--cas-pratique-final---mise-en-place-dun-pipeline-cicd-avec-aws-et-jenkins">Partie 7 : Cas Pratique Final - Mise en Place d'un Pipeline CI/CD avec AWS et Jenkins</a></h2>
<h3 id="objectifs"><a class="header" href="#objectifs">Objectifs</a></h3>
<p>Dans cette partie, vous allez :</p>
<ul>
<li><strong>Appliquer tous les concepts appris</strong> pour configurer un pipeline CI/CD complet avec Jenkins et AWS.</li>
<li><strong>Automatiser le déploiement</strong> d’une application web sur EC2 et la gestion des artefacts avec S3.</li>
</ul>
<hr />
<h3 id="71-mise-en-place-du-dépôt-et-du-jenkinsfile"><a class="header" href="#71-mise-en-place-du-dépôt-et-du-jenkinsfile">7.1 Mise en place du dépôt et du Jenkinsfile</a></h3>
<h4 id="préparation-dun-dépôt-git-avec-un-jenkinsfile"><a class="header" href="#préparation-dun-dépôt-git-avec-un-jenkinsfile">Préparation d’un dépôt Git avec un Jenkinsfile</a></h4>
<p>Pour ce projet, créez un dépôt Git qui contiendra le code de votre application ainsi qu’un Jenkinsfile configuré pour le pipeline CI/CD.</p>
<ol>
<li>
<p><strong>Créer le dépôt Git</strong> :</p>
<ul>
<li>Créez un dépôt Git (ex. : sur GitHub ou GitLab) pour le projet, et ajoutez-y le code source de votre application.</li>
</ul>
</li>
<li>
<p><strong>Écrire un Jenkinsfile</strong> :</p>
<ul>
<li>Le Jenkinsfile contiendra les étapes de build, de test, et de déploiement de votre application.</li>
<li>Structurez-le avec des stages pour chaque étape clé.</li>
</ul>
</li>
</ol>
<p><strong>Exemple de structure de Jenkinsfile</strong> :</p>
<pre><code class="language-groovy">pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                echo 'Building the application...'
                // Ajoutez ici les commandes de build, ex. : sh 'npm install' ou 'mvn clean package'
            }
        }
        stage('Test') {
            steps {
                echo 'Running tests...'
                // Ajoutez ici les commandes pour les tests, ex. : sh 'npm test' ou 'mvn test'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying to EC2...'
                // Appel des scripts ou playbooks Ansible pour le déploiement sur EC2
            }
        }
    }
}
</code></pre>
<hr />
<h3 id="72-déploiement-dune-application-sur-ec2"><a class="header" href="#72-déploiement-dune-application-sur-ec2">7.2 Déploiement d’une application sur EC2</a></h3>
<h4 id="automatiser-la-création-et-la-configuration-de-linfrastructure-avec-ec2-et-ansible"><a class="header" href="#automatiser-la-création-et-la-configuration-de-linfrastructure-avec-ec2-et-ansible">Automatiser la création et la configuration de l’infrastructure avec EC2 et Ansible</a></h4>
<p>Pour cette partie, nous utiliserons Jenkins pour créer des instances EC2 et Ansible pour configurer l’infrastructure et déployer l’application.</p>
<ol>
<li>
<p><strong>Automatiser le lancement d’une instance EC2</strong> :</p>
<ul>
<li>Utilisez AWS CLI dans Jenkins pour lancer une instance EC2, ou configurez un agent EC2 dédié au déploiement.</li>
</ul>
</li>
<li>
<p><strong>Configurer l’instance avec Ansible</strong> :</p>
<ul>
<li>Après le lancement, utilisez Ansible pour installer les dépendances et déployer l’application.</li>
<li>Exemple de tâches Ansible : installation de serveurs web, configuration de l’application, démarrage des services.</li>
</ul>
</li>
</ol>
<p><strong>Exemple de playbook Ansible pour configurer l’instance</strong> :</p>
<pre><code class="language-yaml">- name: Configurer et déployer l'application sur EC2
  hosts: webserver
  tasks:
    - name: Installer Nginx
      yum:
        name: nginx
        state: present
    - name: Copier les fichiers de l'application
      copy:
        src: /path/to/app/
        dest: /var/www/html/
    - name: Démarrer Nginx
      service:
        name: nginx
        state: started
</code></pre>
<h4 id="déploiement-automatisé-de-lapplication-sur-ec2"><a class="header" href="#déploiement-automatisé-de-lapplication-sur-ec2">Déploiement automatisé de l’application sur EC2</a></h4>
<p>Le déploiement peut être automatisé en appelant le playbook Ansible dans le Jenkinsfile.</p>
<p><strong>Exemple d’appel d’Ansible dans un Jenkinsfile</strong> :</p>
<pre><code class="language-groovy">pipeline {
    agent any
    stages {
        stage('Deploy') {
            steps {
                echo 'Deploying the application using Ansible...'
                sh 'ansible-playbook -i inventory.ini deploy-app.yml'
            }
        }
    }
}
</code></pre>
<p>Dans cet exemple :</p>
<ul>
<li><strong>inventory.ini</strong> : Contient l’adresse IP de l’instance EC2 (par exemple, obtenue dynamiquement).</li>
<li><strong>deploy-app.yml</strong> : Le playbook Ansible pour déployer l’application.</li>
</ul>
<hr />
<h3 id="73-gestion-des-artefacts-et-journalisation"><a class="header" href="#73-gestion-des-artefacts-et-journalisation">7.3 Gestion des artefacts et journalisation</a></h3>
<h4 id="sauvegarde-des-artefacts-de-build-dans-s3"><a class="header" href="#sauvegarde-des-artefacts-de-build-dans-s3">Sauvegarde des artefacts de build dans S3</a></h4>
<p>Les artefacts générés (par exemple, les fichiers de build, les logs) peuvent être stockés dans un bucket S3 pour archivage et accès futur.</p>
<ol>
<li>
<p><strong>Configurer un bucket S3 pour les artefacts Jenkins</strong> :</p>
<ul>
<li>Créez un bucket S3 dédié pour stocker les artefacts générés par Jenkins.</li>
<li>Assurez-vous que le rôle IAM associé à l'instance Jenkins a les permissions nécessaires pour écrire dans le bucket.</li>
</ul>
</li>
<li>
<p><strong>Script pour transférer les artefacts vers S3</strong> :</p>
<ul>
<li>Dans le Jenkinsfile, utilisez <code>aws s3 cp</code> pour transférer les artefacts de build vers le bucket S3.</li>
</ul>
</li>
</ol>
<p><strong>Exemple de Jenkinsfile pour sauvegarder les artefacts dans S3</strong> :</p>
<pre><code class="language-groovy">pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                echo 'Building the application...'
                // Exécuter les commandes de build
            }
        }
        stage('Upload Artifacts to S3') {
            steps {
                echo 'Uploading artifacts to S3...'
                sh 'aws s3 cp build/output.zip s3://my-jenkins-artifacts/builds/output.zip'
            }
        }
    }
}
</code></pre>
<hr />
<h3 id="projet-final--créer-un-pipeline-cicd-complet-avec-jenkins-aws-ec2-et-s3"><a class="header" href="#projet-final--créer-un-pipeline-cicd-complet-avec-jenkins-aws-ec2-et-s3">Projet final : Créer un pipeline CI/CD complet avec Jenkins, AWS EC2 et S3</a></h3>
<p><strong>Objectif du projet</strong> : Configurer un pipeline complet pour automatiser le déploiement d'une application web, incluant les étapes de build, de test, et de déploiement sur une instance EC2, ainsi que la gestion des artefacts avec S3.</p>
<p><strong>Étapes du projet</strong> :</p>
<ol>
<li><strong>Préparer le dépôt et le Jenkinsfile</strong> : Créez un Jenkinsfile avec les étapes de build, de test, et de déploiement.</li>
<li><strong>Lancer et configurer une instance EC2</strong> :
<ul>
<li>Utilisez AWS CLI dans Jenkins pour lancer une instance EC2.</li>
<li>Configurez cette instance avec Ansible en installant les dépendances et déployant l’application.</li>
</ul>
</li>
<li><strong>Transférer les artefacts vers S3</strong> : Utilisez le Jenkinsfile pour sauvegarder les artefacts de build dans un bucket S3.</li>
<li><strong>(Optionnel) Configurer CloudWatch pour la surveillance</strong> : Configurez CloudWatch pour surveiller l’utilisation des ressources et recevoir des alertes en cas d’anomalie.</li>
</ol>
<hr />
<h3 id="liens-vers-la-documentation"><a class="header" href="#liens-vers-la-documentation">Liens vers la documentation</a></h3>
<ul>
<li><a href="https://docs.aws.amazon.com/cloudwatch/">Documentation AWS pour CloudWatch</a> [<a href="https://docs.aws.amazon.com/fr_fr/cloudwatch/"><em>fr</em></a>]</li>
<li><a href="https://docs.ansible.com/ansible/latest/scenario_guides/guide_aws.html">Guide d’utilisation d’Ansible avec AWS</a></li>
<li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-services-s3-commands.html">Documentation AWS CLI pour le stockage S3</a> [<a href="https://docs.aws.amazon.com/fr_fr/cli/latest/userguide/cli-services-s3-commands.html"><em>fr</em></a>]</li>
</ul>
<hr />
<h3 id="questions-de-révision"><a class="header" href="#questions-de-révision">Questions de Révision</a></h3>
<details>
<summary><h3 style="display:inline-block">Questions de Révision</h3></summary>
<details>
<summary>Pourquoi utiliser Ansible pour configurer une instance EC2 dans un pipeline CI/CD ?</summary>
<details>
<summary>Solution</summary>
Ansible permet d’automatiser la configuration de l’instance EC2 en installant les dépendances et en déployant l’application, ce qui simplifie et accélère le processus de déploiement.
</details>
</details>
<details>
<
<p>summary&gt;Comment Jenkins peut-il sauvegarder des artefacts dans S3 ?</summary></p>
<details>
<summary>Solution</summary>
Jenkins peut utiliser AWS CLI et le rôle IAM associé à son instance pour exécuter des commandes `aws s3 cp` afin de transférer les artefacts dans un bucket S3.
</details>
</details>
<details>
<summary>Quels sont les avantages de configurer CloudWatch pour une application déployée ?</summary>
<details>
<summary>Solution</summary>
CloudWatch permet de surveiller l’utilisation des ressources (comme le CPU et la mémoire), de collecter des logs et de configurer des alertes en cas d’anomalies, améliorant ainsi la fiabilité de l’application.
</details>
</details>
</details>
<hr />
<h3 id="conseils-pratiques"><a class="header" href="#conseils-pratiques">Conseils Pratiques</a></h3>
<ol>
<li><strong>Utilisez les rôles IAM pour la sécurité</strong> : Associez un rôle IAM à l’instance Jenkins pour gérer les permissions AWS de manière sécurisée, sans avoir à stocker des clés d’accès.</li>
<li><strong>Automatisez les sauvegardes d’artefacts</strong> : Configurez Jenkins pour sauvegarder automatiquement les artefacts critiques (logs, fichiers de build) dans S3 après chaque exécution du pipeline.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../jenkins/sections/06_AWS_automation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ansible/introduction.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../jenkins/sections/06_AWS_automation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ansible/introduction.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
