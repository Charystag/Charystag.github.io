<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Utiliser SCP pour transférer des fichiers sur une VM linux - Panorama du Cloud - Azure</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../exercises/deploy_nginx.html"><strong aria-hidden="true">1.</strong> Déployez un Serveur Web sur une Machine Virtuelle Azure</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../corrections/deploy_nginx.html"><strong aria-hidden="true">1.1.</strong> Correction de la partie non-guidée</a></li></ol></li><li class="chapter-item expanded "><a href="../exercises/multi_tier.html"><strong aria-hidden="true">2.</strong> Déployez une Application Multi-Tiers avec Azure</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../corrections/multi_tier.html"><strong aria-hidden="true">2.1.</strong> Correction</a></li></ol></li><li class="chapter-item expanded "><a href="../exercises/deploy_appservice.html"><strong aria-hidden="true">3.</strong> Déployez une Application Flask sur Azure App Service via Git</a></li><li class="chapter-item expanded "><a href="../exercises/static_website_blob.html"><strong aria-hidden="true">4.</strong> Hébergement d'un Site Web Statique avec Azure Blob Storage</a></li><li class="chapter-item expanded affix "><li class="part-title">Tutoriels</li><li class="chapter-item expanded "><a href="../tutoriels/smb.html"><strong aria-hidden="true">5.</strong> Monter un partage de fichiers SMB sur Windows ou macOS</a></li><li class="chapter-item expanded "><a href="../tutoriels/resources_group.html"><strong aria-hidden="true">6.</strong> Création et Gestion d'un groupe de resources</a></li><li class="chapter-item expanded "><a href="../tutoriels/tags.html"><strong aria-hidden="true">7.</strong> Déploiement et Gestion des étiquettes</a></li><li class="chapter-item expanded "><a href="../tutoriels/vm.html"><strong aria-hidden="true">8.</strong> Déployer une machine virtuelle Windows/Linux</a></li><li class="chapter-item expanded "><a href="../tutoriels/ssh.html"><strong aria-hidden="true">9.</strong> Connection à une VM avec RDP ou SSH sur azure</a></li><li class="chapter-item expanded "><a href="../tutoriels/scp.html" class="active"><strong aria-hidden="true">10.</strong> Utiliser SCP pour transférer des fichiers sur une VM linux</a></li><li class="chapter-item expanded "><a href="../tutoriels/snapshots.html"><strong aria-hidden="true">11.</strong> Gérer les sauvegardes et les snapshots des VMS</a></li><li class="chapter-item expanded "><a href="../tutoriels/storage.html"><strong aria-hidden="true">12.</strong> Configurer un compte de stockage Azure</a></li><li class="chapter-item expanded "><a href="../tutoriels/azure_blob_storage.html"><strong aria-hidden="true">13.</strong> Utiliser Azure Blob Storage pour stocker et gérer des fichiers</a></li><li class="chapter-item expanded affix "><li class="part-title">Notions</li><li class="chapter-item expanded "><a href="../notions/azure_monitor.html"><strong aria-hidden="true">14.</strong> Azure Monitor</a></li><li class="chapter-item expanded "><a href="../notions/ssh.html"><strong aria-hidden="true">15.</strong> protocole SSH</a></li><li class="chapter-item expanded "><a href="../notions/rdp.html"><strong aria-hidden="true">16.</strong> protocole RDP</a></li><li class="chapter-item expanded "><a href="../notions/storage.html"><strong aria-hidden="true">17.</strong> Les redondances de stockage</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Panorama du Cloud - Azure</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="tutoriel--utiliser-le-protocole-scp-pour-transférer-des-fichiers-sur-une-vm-linux-dans-azure"><a class="header" href="#tutoriel--utiliser-le-protocole-scp-pour-transférer-des-fichiers-sur-une-vm-linux-dans-azure"><strong>Tutoriel : Utiliser le protocole SCP pour transférer des fichiers sur une VM Linux dans Azure</strong></a></h1>
<p><strong>SCP (Secure Copy Protocol)</strong> est un outil puissant pour transférer des fichiers entre un système local et une machine virtuelle Linux en utilisant le protocole SSH. Ce guide vous explique comment utiliser SCP pour transférer des fichiers sur une VM Linux hébergée sur Azure.</p>
<hr />
<h2 id="prérequis"><a class="header" href="#prérequis"><strong>Prérequis</strong></a></h2>
<ol>
<li>
<p>Une <strong>machine virtuelle Linux</strong> déployée sur Azure avec :</p>
<ul>
<li>Un <strong>port SSH (22)</strong> ouvert dans les règles du groupe de sécurité réseau (NSG).</li>
<li>Une <strong>clé SSH</strong> ou un mot de passe pour vous connecter à la VM.</li>
</ul>
</li>
<li>
<p>Une adresse IP publique associée à la VM.</p>
</li>
<li>
<p><strong>SCP installé</strong> sur votre système local :</p>
<ul>
<li>SCP est inclus par défaut sur les systèmes <strong>Linux</strong> et <strong>MacOS</strong>.</li>
<li>Pour <strong>Windows</strong>, utilisez un outil comme <strong>PuTTY (avec pscp)</strong> ou installez <strong>OpenSSH</strong> via PowerShell.</li>
</ul>
</li>
</ol>
<hr />
<h2 id="Étape-1--vérifiez-la-connectivité-ssh-avec-la-vm"><a class="header" href="#Étape-1--vérifiez-la-connectivité-ssh-avec-la-vm"><strong>Étape 1 : Vérifiez la connectivité SSH avec la VM</strong></a></h2>
<ol>
<li>
<p>Récupérez l'adresse IP publique de la VM :</p>
<ul>
<li>Dans le portail Azure, allez dans <strong>Machines virtuelles &gt; Votre VM &gt; Vue d’ensemble</strong>.</li>
<li>Notez l'<strong>adresse IP publique</strong>.</li>
</ul>
</li>
<li>
<p>Testez la connexion SSH depuis votre terminal :</p>
<pre><code class="language-bash">ssh &lt;NomUtilisateur&gt;@&lt;AdresseIP&gt;
</code></pre>
<p>Exemple :</p>
<pre><code class="language-bash">ssh azureuser@20.50.60.70
</code></pre>
<p>Si la connexion est réussie, vous êtes prêt à utiliser SCP.</p>
</li>
</ol>
<hr />
<h2 id="Étape-2--transférer-des-fichiers-vers-la-vm-avec-scp"><a class="header" href="#Étape-2--transférer-des-fichiers-vers-la-vm-avec-scp"><strong>Étape 2 : Transférer des fichiers vers la VM avec SCP</strong></a></h2>
<h3 id="transfert-dun-fichier-unique"><a class="header" href="#transfert-dun-fichier-unique"><strong>Transfert d’un fichier unique</strong></a></h3>
<p>Utilisez la commande suivante pour copier un fichier local vers votre VM Linux :</p>
<pre><code class="language-bash">scp &lt;CheminLocalDuFichier&gt; &lt;NomUtilisateur&gt;@&lt;AdresseIP&gt;:&lt;CheminCible&gt;
</code></pre>
<ul>
<li><strong><CheminLocalDuFichier></strong> : Chemin complet du fichier à transférer.</li>
<li><strong><NomUtilisateur></strong> : Nom d'utilisateur pour la connexion SSH (souvent <code>azureuser</code>).</li>
<li><strong><AdresseIP></strong> : Adresse IP publique de la VM.</li>
<li><strong><CheminCible></strong> : Chemin où le fichier sera stocké sur la VM.</li>
</ul>
<h4 id="exemple-"><a class="header" href="#exemple-">Exemple :</a></h4>
<p>Pour copier un fichier nommé <code>rapport.txt</code> dans le répertoire <code>/home/azureuser</code> de la VM :</p>
<pre><code class="language-bash">scp ~/Documents/rapport.txt azureuser@20.50.60.70:/home/azureuser/
</code></pre>
<hr />
<h3 id="transfert-de-plusieurs-fichiers-ou-répertoires"><a class="header" href="#transfert-de-plusieurs-fichiers-ou-répertoires"><strong>Transfert de plusieurs fichiers ou répertoires</strong></a></h3>
<p>Pour transférer un répertoire entier vers la VM, utilisez l'option <code>-r</code> (récursif) :</p>
<pre><code class="language-bash">scp -r &lt;CheminLocalDuDossier&gt; &lt;NomUtilisateur&gt;@&lt;AdresseIP&gt;:&lt;CheminCible&gt;
</code></pre>
<h4 id="exemple--1"><a class="header" href="#exemple--1">Exemple :</a></h4>
<p>Pour copier un dossier <code>projet</code> vers <code>/home/azureuser/</code> sur la VM :</p>
<pre><code class="language-bash">scp -r ~/projet azureuser@20.50.60.70:/home/azureuser/
</code></pre>
<hr />
<h2 id="Étape-3--télécharger-des-fichiers-depuis-la-vm"><a class="header" href="#Étape-3--télécharger-des-fichiers-depuis-la-vm"><strong>Étape 3 : Télécharger des fichiers depuis la VM</strong></a></h2>
<p>Pour copier des fichiers ou répertoires de la VM vers votre machine locale, inversez les chemins dans la commande SCP.</p>
<h3 id="téléchargement-dun-fichier-unique"><a class="header" href="#téléchargement-dun-fichier-unique"><strong>Téléchargement d’un fichier unique</strong></a></h3>
<pre><code class="language-bash">scp &lt;NomUtilisateur&gt;@&lt;AdresseIP&gt;:&lt;CheminDuFichierSurLaVM&gt; &lt;CheminLocalDeDestination&gt;
</code></pre>
<h4 id="exemple--2"><a class="header" href="#exemple--2">Exemple :</a></h4>
<p>Pour copier un fichier <code>rapport.txt</code> depuis la VM vers le répertoire local <code>~/Documents</code> :</p>
<pre><code class="language-bash">scp azureuser@20.50.60.70:/home/azureuser/rapport.txt ~/Documents/
</code></pre>
<h3 id="téléchargement-dun-répertoire"><a class="header" href="#téléchargement-dun-répertoire"><strong>Téléchargement d’un répertoire</strong></a></h3>
<p>Utilisez l'option <code>-r</code> pour copier un répertoire entier :</p>
<pre><code class="language-bash">scp -r &lt;NomUtilisateur&gt;@&lt;AdresseIP&gt;:&lt;CheminDuDossierSurLaVM&gt; &lt;CheminLocalDeDestination&gt;
</code></pre>
<h4 id="exemple--3"><a class="header" href="#exemple--3">Exemple :</a></h4>
<p>Pour copier un dossier <code>projet</code> depuis <code>/home/azureuser</code> de la VM vers <code>~/Documents</code> sur votre machine locale :</p>
<pre><code class="language-bash">scp -r azureuser@20.50.60.70:/home/azureuser/projet ~/Documents/
</code></pre>
<hr />
<h2 id="Étape-4--résolution-des-problèmes-courants"><a class="header" href="#Étape-4--résolution-des-problèmes-courants"><strong>Étape 4 : Résolution des problèmes courants</strong></a></h2>
<ol>
<li>
<p><strong>Erreur "Permission denied"</strong> :</p>
<ul>
<li>Vérifiez que vous utilisez le bon nom d'utilisateur et que votre clé SSH ou mot de passe est correct.</li>
<li>Assurez-vous que le port 22 est ouvert dans les <strong>règles NSG</strong> de la VM.</li>
</ul>
</li>
<li>
<p><strong>Connexion impossible (Timeout)</strong> :</p>
<ul>
<li>Vérifiez que votre adresse IP est autorisée dans les règles du pare-feu réseau Azure.</li>
<li>Confirmez que la VM est en cours d'exécution.</li>
</ul>
</li>
<li>
<p><strong>Accès refusé au chemin cible sur la VM</strong> :</p>
<ul>
<li>Assurez-vous que l'utilisateur a les permissions nécessaires pour écrire dans le répertoire cible.</li>
</ul>
</li>
</ol>
<hr />
<h2 id="Étape-5--automatisation-avec-des-scripts"><a class="header" href="#Étape-5--automatisation-avec-des-scripts"><strong>Étape 5 : Automatisation avec des scripts</strong></a></h2>
<p>Vous pouvez automatiser les transferts de fichiers avec un script Shell.</p>
<h3 id="exemple-de-script-pour-transférer-des-fichiers-vers-la-vm-"><a class="header" href="#exemple-de-script-pour-transférer-des-fichiers-vers-la-vm-">Exemple de script pour transférer des fichiers vers la VM :</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Variables
USER="azureuser"
IP="20.50.60.70"
LOCAL_PATH="/path/to/local/file"
REMOTE_PATH="/path/to/remote/destination"

# Transférer un fichier
scp $LOCAL_PATH $USER@$IP:$REMOTE_PATH
</code></pre>
<h3 id="exemple-de-script-pour-sauvegarder-des-fichiers-depuis-la-vm-"><a class="header" href="#exemple-de-script-pour-sauvegarder-des-fichiers-depuis-la-vm-">Exemple de script pour sauvegarder des fichiers depuis la VM :</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Variables
USER="azureuser"
IP="20.50.60.70"
REMOTE_PATH="/path/to/remote/file"
LOCAL_PATH="/path/to/local/destination"

# Télécharger un fichier
scp $USER@$IP:$REMOTE_PATH $LOCAL_PATH
</code></pre>
<hr />
<h2 id="bonnes-pratiques-pour-le-transfert-scp"><a class="header" href="#bonnes-pratiques-pour-le-transfert-scp"><strong>Bonnes pratiques pour le transfert SCP</strong></a></h2>
<ol>
<li><strong>Utilisez des clés SSH</strong> :
<ul>
<li>Préférez les clés SSH au lieu des mots de passe pour des connexions plus sécurisées.</li>
</ul>
</li>
<li><strong>Réduisez l’exposition publique</strong> :
<ul>
<li>Utilisez des <strong>règles NSG</strong> pour limiter l’accès SSH à des adresses IP spécifiques.</li>
</ul>
</li>
<li><strong>Compression</strong> :
<ul>
<li>Ajoutez l'option <code>-C</code> pour compresser les fichiers pendant le transfert, améliorant la vitesse.</li>
</ul>
<pre><code class="language-bash">scp -C &lt;CheminLocalDuFichier&gt; &lt;NomUtilisateur&gt;@&lt;AdresseIP&gt;:&lt;CheminCible&gt;
</code></pre>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tutoriels/ssh.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../tutoriels/snapshots.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tutoriels/ssh.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../tutoriels/snapshots.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
