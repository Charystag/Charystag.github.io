<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Bandit25-&gt;26 - Bandit Challenge</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Challenge Overview</a></li><li class="chapter-item expanded "><a href="bandit00.html"><strong aria-hidden="true">2.</strong> Login to first Challenge</a></li><li class="chapter-item expanded "><a href="bandit0.html"><strong aria-hidden="true">3.</strong> Bandit0-&gt;1</a></li><li class="chapter-item expanded "><a href="bandit1.html"><strong aria-hidden="true">4.</strong> Bandit1-&gt;2</a></li><li class="chapter-item expanded "><a href="bandit2.html"><strong aria-hidden="true">5.</strong> Bandit2-&gt;3</a></li><li class="chapter-item expanded "><a href="bandit3.html"><strong aria-hidden="true">6.</strong> Bandit3-&gt;4</a></li><li class="chapter-item expanded "><a href="bandit4.html"><strong aria-hidden="true">7.</strong> Bandit4-&gt;5</a></li><li class="chapter-item expanded "><a href="bandit5.html"><strong aria-hidden="true">8.</strong> Bandit5-&gt;6</a></li><li class="chapter-item expanded "><a href="bandit6.html"><strong aria-hidden="true">9.</strong> Bandit6-&gt;7</a></li><li class="chapter-item expanded "><a href="bandit7.html"><strong aria-hidden="true">10.</strong> Bandit7-&gt;8</a></li><li class="chapter-item expanded "><a href="bandit8.html"><strong aria-hidden="true">11.</strong> Bandit8-&gt;9</a></li><li class="chapter-item expanded "><a href="bandit9.html"><strong aria-hidden="true">12.</strong> Bandit9-&gt;10</a></li><li class="chapter-item expanded "><a href="bandit10.html"><strong aria-hidden="true">13.</strong> Bandit10-&gt;11</a></li><li class="chapter-item expanded "><a href="bandit11.html"><strong aria-hidden="true">14.</strong> Bandit11-&gt;12</a></li><li class="chapter-item expanded "><a href="bandit12.html"><strong aria-hidden="true">15.</strong> Bandit12-&gt;13</a></li><li class="chapter-item expanded "><a href="bandit13.html"><strong aria-hidden="true">16.</strong> Bandit13-&gt;14</a></li><li class="chapter-item expanded "><a href="bandit14.html"><strong aria-hidden="true">17.</strong> Bandit14-&gt;15</a></li><li class="chapter-item expanded "><a href="bandit15.html"><strong aria-hidden="true">18.</strong> Bandit15-&gt;16</a></li><li class="chapter-item expanded "><a href="bandit16.html"><strong aria-hidden="true">19.</strong> Bandit16-&gt;17</a></li><li class="chapter-item expanded "><a href="bandit17.html"><strong aria-hidden="true">20.</strong> Bandit17-&gt;18</a></li><li class="chapter-item expanded "><a href="bandit18.html"><strong aria-hidden="true">21.</strong> Bandit18-&gt;19</a></li><li class="chapter-item expanded "><a href="bandit19.html"><strong aria-hidden="true">22.</strong> Bandit19-&gt;20</a></li><li class="chapter-item expanded "><a href="bandit20.html"><strong aria-hidden="true">23.</strong> Bandit20-&gt;21</a></li><li class="chapter-item expanded "><a href="bandit21.html"><strong aria-hidden="true">24.</strong> Bandit21-&gt;22</a></li><li class="chapter-item expanded "><a href="bandit22.html"><strong aria-hidden="true">25.</strong> Bandit22-&gt;23</a></li><li class="chapter-item expanded "><a href="bandit23.html"><strong aria-hidden="true">26.</strong> Bandit23-&gt;24</a></li><li class="chapter-item expanded "><a href="bandit24.html"><strong aria-hidden="true">27.</strong> Bandit24-&gt;25</a></li><li class="chapter-item expanded "><a href="bandit25.html" class="active"><strong aria-hidden="true">28.</strong> Bandit25-&gt;26</a></li><li class="chapter-item expanded "><a href="bandit26.html"><strong aria-hidden="true">29.</strong> Bandit26-&gt;27</a></li><li class="chapter-item expanded "><a href="bandit27.html"><strong aria-hidden="true">30.</strong> Bandit27-&gt;28</a></li><li class="chapter-item expanded "><a href="bandit28.html"><strong aria-hidden="true">31.</strong> Bandit28-&gt;29</a></li><li class="chapter-item expanded "><a href="bandit29.html"><strong aria-hidden="true">32.</strong> Bandit29-&gt;30</a></li><li class="chapter-item expanded "><a href="bandit30.html"><strong aria-hidden="true">33.</strong> Bandit30-&gt;31</a></li><li class="chapter-item expanded "><a href="bandit31.html"><strong aria-hidden="true">34.</strong> Bandit31-&gt;32</a></li><li class="chapter-item expanded "><a href="bandit32.html"><strong aria-hidden="true">35.</strong> Bandit32-&gt;33</a></li><li class="chapter-item expanded "><a href="bandit33.html"><strong aria-hidden="true">36.</strong> Bandit33-&gt;34</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Bandit Challenge</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bandit25-26"><a class="header" href="#bandit25-26"><a href="https://overthewire.org/wargames/bandit/bandit26.html">Bandit25-&gt;26</a></a></h1>
<h2 id="level-goal"><a class="header" href="#level-goal">Level Goal</a></h2>
<p>Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 <strong>is not /bin/bash</strong>, but something else.
Find out what it is, how it works and how to break out of it.</p>
<h2 id="commands-useful-to-solve-the-level"><a class="header" href="#commands-useful-to-solve-the-level">Commands useful to solve the level</a></h2>
<ul>
<li><a href="https://man7.org/linux/man-pages/man1/vi.1p.html">vi</a></li>
<li><a href="https://man7.org/linux/man-pages/man1/more.1.html">more</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#cat-invocation">cat</a></li>
</ul>
<h2 id="helpful-reading-material"><a class="header" href="#helpful-reading-material">Helpful Reading Material</a></h2>
<ul>
<li><a href="https://vimdoc.sourceforge.net/htmldoc/options.html">Vim Documentation Options</a></li>
<li><a href="https://man7.org/linux/man-pages/man5/passwd.5.html">passwd(5) man page</a></li>
<li><a href="https://unix.stackexchange.com/questions/744263/does-ssh-run-commands-rather-than-shell-itself-in-a-login-shell">Does ssh run commands rather than itself in a login shell</a> <em>Unix StackExchange
Discussion</em></li>
<li><a href="https://vimdoc.sourceforge.net/htmldoc/various.html">Vim various commands</a></li>
</ul>
<h2 id="where-to-start"><a class="header" href="#where-to-start">Where to start?</a></h2>
<p>By listing the contents of the directory, we can see that there is a private key that we should use to log in as the user bandit26, this means that
this isn't where the true challenge of this level is. Let's try and analyse the level following the guidelines at the beginning.</p>
<details>
<summary><h3 style="display:inline-block">Part 1 : Retrieving bandit26 shell</h3></summary>
<p>The first thing we need to do is to retrieve bandit26 shell, as we know that this shell is not /bin/bash.</p>
<details>
<summary>Hint</summary>
<p>Using the <a href="https://man7.org/linux/man-pages/man5/passwd.5.html">passwd(5) man page</a>, can you figure out a way to retrieve the shell that bandit26
gets when it logs in and to view its contents?</p>
</details>
<details>
<summary>Solution</summary>
<p>Using the <code>passwd(5)</code> man page, we know that the informations for the bandit 26 user are stored in the <code>/etc/passwd</code> file. This file is readable
by everyone so we can print its content and <code>grep</code> only the lines containing bandit26. Here is the command we'll run, alongside its output :</p>
<pre><code class="language-bash">bandit25@bandit:~$ cat /etc/passwd | grep bandit26
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
bandit25@bandit:~$
</code></pre>
<p>We know from the <code>passwd(5)</code> man page that the last field is the bandit26 user's shell : <code>/usr/bin/showtext</code>.</p>
<p>Let's print the contents of this file :</p>
<pre><code class="language-bash">#!/bin/sh

export TERM=linux

exec more ~/text.txt
exit 0
</code></pre>
<p>We see here that the script sets one variable <code>TERM</code> and then runs the <code>more</code> utility.</p>
<p>One thing we can already notice is that the <code>showtext</code> executable doesn't take any argument, so we won't be able to ssh our way into bandit26 account
running a command like we did in <a href="bandit18.html">level18</a> (see
<a href="https://unix.stackexchange.com/questions/744263/does-ssh-run-commands-rather-than-shell-itself-in-a-login-shell">how ssh commands are run</a> for more
explanations). We'll have to find another way to get in.</p>
</details>
</details>
<details>
<summary><h3 style="display:inline-block">Part 2 : Let's scroll that thing</h3></summary>
<p>When we first ssh our way into bandit26, we see that the <code>showtext</code> executable is ran. It prints the text <strong>bandit26</strong> in ASCII art and then exits.</p>
<p>We already know that the <code>showtext</code> executable uses more, the real challenge here is to take advantage of the <code>more</code> capabilities to run commands.
To do so, we need to make it scrollable so that it shows its command prompt.</p>
<details>
<summary>Hint</summary>
<p>By doing some tests with files on your own computer, can you figure out when more is scrollable and where it isn't? Doing so, could you make it
scrollable when logging in into bandit26 and find which command to run to get a text editor?</p>
</details>
<details>
<summary>Solution</summary>
<p>Although it is not very intuitive, you might have noticed that when the window size is smaller than the number of text lines, <code>more</code> becomes scrollable.
We're going to use this capability of the <code>more</code> utility to break out of it. Let's minimize our window to less than 6 lines and then ssh into bandit26.</p>
<blockquote>
<p>There might be a more elegant solution through the use of a terminal multiplexer like <a href="https://github.com/tmux/tmux/wiki">tmux</a> but the idea will basically
be the same. I'll provide a solution using <code>tmux(1)</code> once I learn to use it.</p>
</blockquote>
<p>We can now enter commands (see <a href="https://man7.org/linux/man-pages/man1/more.1.html">more</a> man page for the full list). We are going to use the <code>v</code> command
in order to open the vim editor.</p>
<p>We can now bring our window size back to normal.</p>
</details>
</details>
<details>
<summary><h3 style="display:inline-block">Part 3 : Byebye showtext</h3></summary>
<p>Now that we got inside <code>vim</code>, we have to get rid of this nice yet useless shell and get a real one.</p>
<details>
<summary>Hint</summary>
<p>Using the <a href="https://vimdoc.sourceforge.net/htmldoc/various.html">various remaining commands</a> file of the vim help manual,
can you figure out a way to get a shell while in the vim editor?</p>
</details>
<details>
<summary>Solution</summary>
<p>The command <code>:shell</code> is the one we need. Remember that you need to press <code>&lt;ESC&gt;</code> first to get into normal mode.
However, when running it for the first time we can see that nothing <strong>seems</strong> to happen. The truth is that something
really happened in front of our eyes. The shell of the user bandit26 was launched and then exited as it is the <code>showtext</code> executable.</p>
<blockquote>
<p>To convince yourself that it really happened, you can minimize the window to less than 6 lines before running the <code>:shell</code> command</p>
</blockquote>
<p>We now need to change the default shell for user bandit26 in order to finally get out of that showtext hell.</p>
</details>
</details>
<details>
<summary><h3 style="display:inline-block">Part 4 : Getting bash back</h3></summary>
<p>We now know that we can run a shell, let's try to change the default shell to <code>/usr/bin/bash</code> in order to actually run a shell.</p>
<details>
<summary>Hint</summary>
<p>Using the <a href="https://vimdoc.sourceforge.net/htmldoc/options.html">Vim Documentation Options</a>, can you figure out how to view, then change, the
shell we're using when running the <code>:shell</code> command?</p>
</details>
<details>
<summary>Solution</summary>
<p>The command we're looking for is <code>:set</code> which allows us to view/change settings for the options we specify.</p>
<p>By running <code>:set shell</code> we can view the shell we're using (which in our case outputs <code>/usr/bin/showtext</code>).</p>
<p>To change the shell, we just have to run <code>:set shell=/usr/bin/bash</code>, we can then run <code>:shell</code> and get a shell for the user bandit26.</p>
</details>
</details>
<details>
<summary><h3 style="display:inline-block">Full Solution</h3></summary>
<ol>
<li>Minimize the window and ssh into bandit26 account to make the <code>more</code> utility scrollable.</li>
<li>Enter the <code>v</code> command to open the ViM text editor</li>
<li><code>:set shell=/usr/bin/bash</code> in order to set the default shell to a real shell</li>
<li><code>:shell</code> to open the bash shell for the user bandit26</li>
</ol>
</details>
<p>You can now jump to the <a href="bandit26.html">next level</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="bandit24.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="bandit26.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="bandit24.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="bandit26.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
